# Example: Using both external PostgreSQL and Redis
# Useful for production deployments with managed services

# Before deploying, create a secret with your database password:
#
#   kubectl create secret generic immich-external-db-secret \
#     --namespace immich \
#     --from-literal=db-password='YOUR-SECURE-PASSWORD'
#
# Or apply this YAML (after base64 encoding your password):
#
#   apiVersion: v1
#   kind: Secret
#   metadata:
#     name: immich-external-db-secret
#     namespace: immich
#   type: Opaque
#   stringData:
#     db-password: YOUR-SECURE-PASSWORD

# Disable bundled services when using external ones
postgresql:
  enabled: false

redis:
  enabled: false

# Configure external services
immich:
  database:
    host: 'postgres.prod.example.com'
    port: 5432
    username: 'immich_prod'
    name: 'immich_production'
    # Reference secret created above
    password:
      valueFrom:
        secretKeyRef:
          name: immich-external-db-secret
          key: db-password

  redis:
    host: 'redis.prod.example.com'
    port: 6379

persistence:
  library:
    storageClass: null # Change to your storage class unless you want to use you default provider
    size: 500Gi
  external:
    storageClass: null # Change to your storage class unless you want to use you default provider
    size: 200Gi
  machine-learning-cache:
    storageClass: null # Change to your storage class unless you want to use you default provider
    size: 20Gi
